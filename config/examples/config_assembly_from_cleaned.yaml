# =============================================================================
# Example Config: Assembly from Pre-Cleaned Reads
# =============================================================================
# This configuration skips QC and starts assembly from pre-cleaned reads.
# Use this when you already have cleaned reads from a previous QC run or
# another pipeline.
#
# Two-Stage Assembly Workflow:
#   Stage 1: MEGAHIT assemblies (per-sample or per-group)
#   Stage 2: Rename contigs with unique IDs
#   Stage 3: Concatenate all renamed contigs
#   Stage 4: Flye meta-assembly for final polished output
#
# REQUIREMENTS:
# - Cleaned reads must be in paired-end format:
#   {sample}_R1.fastq.gz and {sample}_R2.fastq.gz
# - Files must be in the directory specified by cleaned_reads_dir
#
# Usage: snakemake --configfile config/examples/config_assembly_from_cleaned.yaml
# =============================================================================

output_dir: "results_assembly_only"

# Pipeline control
pipeline:
  start_from: "cleaned_reads"   # Skip QC, start from cleaned reads
  run_assembly: true            # Run assembly module

  # Assembly strategy (IMPORTANT: Choose based on your analysis goals)
  # ----------------------------------------------------------------------------
  # "by_sample" (DEFAULT, RECOMMENDED):
  #   - Stage 1: MEGAHIT assembles each sample separately
  #   - Stage 2-4: Contigs are renamed, concatenated, and meta-assembled with Flye
  #   - Use for most virome studies
  #   - Output: Final meta-assembled contigs + per-sample MEGAHIT assemblies
  #
  # "by_group":
  #   - Stage 1: MEGAHIT assembles user-defined groups of related samples
  #   - Stage 2-4: Contigs are renamed, concatenated, and meta-assembled with Flye
  #   - Use when samples are biologically related (same patient, same treatment)
  #   - Requires: groups_file parameter (TSV with sample_id and group_id columns)
  #   - Output: Final meta-assembled contigs + per-group MEGAHIT assemblies
  #
  # NOTE: Global "coassembly" has been removed - research shows it performs
  # worst on all assembly metrics. Use "by_sample" or "by_group" instead.
  # ----------------------------------------------------------------------------
  assembly_strategy: "by_sample"

  # Groups file (required only if assembly_strategy="by_group")
  # See config/examples/sample_groups.tsv for format
  # groups_file: "config/examples/sample_groups.tsv"

  cleaned_reads_dir: "path/to/cleaned/reads"  # UPDATE THIS PATH!

# Assembly parameters
assembly:
  min_contig_length: 1000       # Keep contigs >= 1kb (MEGAHIT parameter)

# Samples - specify manually or use auto-detection
# NOTE: Sample names must match filenames in cleaned_reads_dir
samples:
  sample1:
    # Paths not used when start_from="cleaned_reads"
    # But sample names must be defined
    r1: "dummy"
    r2: "dummy"
  sample2:
    r1: "dummy"
    r2: "dummy"

# OR use auto-detection (sample names from cleaned_reads_dir)
# sample_auto_detection:
#   enabled: true
#   input_dir: "path/to/cleaned/reads"  # Same as cleaned_reads_dir
#   r1_pattern: "*_R1.fastq.gz"
#   r2_pattern: "*_R2.fastq.gz"

resources:
  default_threads: 8
  default_mem_mb: 16000
